{% extends '../base.html' %}
{% block content %}
{% include './navbar.html' %}
{% include './sidebar.html' %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="p-8 sm:ml-64 mt-14">
        <main>
            <!-- Timezone and Welcome Message -->
            <div class="mb-10 flex flex-col md:flex-row justify-between items-center bg-white rounded-xl shadow-lg p-6">
                <div>
                    <h1 class="text-4xl font-bold text-gray-900 mb-2">Welcome back, Alex!</h1>
                    <p class="text-xl text-gray-600">Ready to continue your learning journey?</p>
                </div>
                <div class="text-right mt-4 md:mt-0">
                    <p class="text-lg text-gray-600">Your current time</p>
                    <p class="text-3xl font-semibold text-gray-900" id="current-time"></p>
                    <p class="text-lg text-gray-600">{{ request.user.timezone }}</p>
                </div>
            </div>
    
            <!-- Key Metrics -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
                <div class="bg-white rounded-xl shadow-lg p-6 flex items-center">
                    <div class="rounded-full bg-blue-100 p-4 mr-6">
                        <i class="fas fa-graduation-cap text-blue-600 text-3xl"></i>
                    </div>
                    <div>
                        <p class="text-xl font-medium text-gray-600">Courses Enrolled</p>
                        <p class="text-4xl font-semibold text-gray-900">5</p>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 flex items-center">
                    <div class="rounded-full bg-green-100 p-4 mr-6">
                        <i class="fas fa-chart-line text-green-600 text-3xl"></i>
                    </div>
                    <div>
                        <p class="text-xl font-medium text-gray-600">Overall Progress</p>
                        <p class="text-4xl font-semibold text-gray-900">72%</p>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 flex items-center">
                    <div class="rounded-full bg-purple-100 p-4 mr-6">
                        <i class="fas fa-clock text-purple-600 text-3xl"></i>
                    </div>
                    <div>
                        <p class="text-xl font-medium text-gray-600">Study Time</p>
                        <p class="text-4xl font-semibold text-gray-900">32h</p>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 flex items-center">
                    <div class="rounded-full bg-yellow-100 p-4 mr-6">
                        <i class="fas fa-medal text-yellow-600 text-3xl"></i>
                    </div>
                    <div>
                        <p class="text-xl font-medium text-gray-600">Badges Earned</p>
                        <p class="text-4xl font-semibold text-gray-900">7</p>
                    </div>
                </div>
            </div>
    
            <!-- Main Content Area -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Left Column -->
                <div class="lg:col-span-2 space-y-8">
                    <!-- Progress Chart -->
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h2 class="text-2xl font-semibold text-gray-900 mb-6">Learning Progress</h2>
                        <canvas id="progressChart" height="250"></canvas>
                    </div>
    
                    <!-- Recent Activity -->
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h2 class="text-2xl font-semibold text-gray-900 mb-6">Recent Activity</h2>
                        <div class="space-y-6">
                            <div class="flex items-center">
                                <div class="rounded-full bg-blue-100 p-3 mr-6">
                                    <i class="fas fa-book text-blue-600 text-2xl"></i>
                                </div>
                                <div>
                                    <p class="text-lg font-medium text-gray-900">Completed Chapter 5: Advanced Python</p>
                                    <p class="text-base text-gray-600">2 hours ago</p>
                                </div>
                            </div>
                            <div class="flex items-center">
                                <div class="rounded-full bg-green-100 p-3 mr-6">
                                    <i class="fas fa-trophy text-green-600 text-2xl"></i>
                                </div>
                                <div>
                                    <p class="text-lg font-medium text-gray-900">Earned "Python Master" Badge</p>
                                    <p class="text-base text-gray-600">Yesterday</p>
                                </div>
                            </div>
                            <div class="flex items-center">
                                <div class="rounded-full bg-purple-100 p-3 mr-6">
                                    <i class="fas fa-comments text-purple-600 text-2xl"></i>
                                </div>
                                <div>
                                    <p class="text-lg font-medium text-gray-900">Posted in "Web Development" Forum</p>
                                    <p class="text-base text-gray-600">2 days ago</p>
                                </div>
                            </div>
                        </div>
                    </div>
    
                    <!-- Skill Progress -->
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h2 class="text-2xl font-semibold text-gray-900 mb-6">Skill Progress</h2>
                        <div class="grid grid-cols-2 gap-6">
                            <div>
                                <canvas id="pythonSkillChart"></canvas>
                            </div>
                            <div>
                                <canvas id="webDevSkillChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
    
                <!-- Middle Column -->
                <div class="space-y-8">

                    <!-- Course Progress -->
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h2 class="text-2xl font-semibold text-gray-900 mb-6">Course Progress</h2>
                        <div class="space-y-6">
                            <div>
                                <div class="flex justify-between mb-2">
                                    <span class="text-lg font-medium text-gray-700">Python for Beginners</span>
                                    <span class="text-lg font-semibold text-gray-900">85%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-4">
                                    <div class="bg-blue-600 h-4 rounded-full" style="width: 85%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-2">
                                    <span class="text-lg font-medium text-gray-700">Web Development Fundamentals</span>
                                    <span class="text-lg font-semibold text-gray-900">60%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-4">
                                    <div class="bg-green-600 h-4 rounded-full" style="width: 60%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-2">
                                    <span class="text-lg font-medium text-gray-700">Data Science Basics</span>
                                    <span class="text-lg font-semibold text-gray-900">40%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-4">
                                    <div class="bg-purple-600 h-4 rounded-full" style="width: 40%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
    
                    
    
                    <!-- Badges -->
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h2 class="text-2xl font-semibold text-gray-900 mb-6">Recent Badges</h2>
                        <div class="grid grid-cols-3 gap-6">
                            <div class="text-center">
                                <div class="rounded-full bg-yellow-100 p-6 mb-4 mx-auto w-24 h-24 flex items-center justify-center">
                                    <i class="fas fa-award text-yellow-600 text-4xl"></i>
                                </div>
                                <p class="text-lg font-medium text-gray-900">Python Master</p>
                            </div>
                            <div class="text-center">
                                <div class="rounded-full bg-green-100 p-6 mb-4 mx-auto w-24 h-24 flex items-center justify-center">
                                    <i class="fas fa-users text-green-600 text-4xl"></i>
                                </div>
                                <p class="text-lg font-medium text-gray-900">Team Player</p>
                            </div>
                            <div class="text-center">
                                <div class="rounded-full bg-blue-100 p-6 mb-4 mx-auto w-24 h-24 flex items-center justify-center">
                                    <i class="fas fa-brain text-blue-600 text-4xl"></i>
                                </div>
                                <p class="text-lg font-medium text-gray-900">Quick Learner</p>
                            </div>
                        </div>
                    </div>
    
                    <!-- Learning Recommendations -->
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h2 class="text-2xl font-semibold text-gray-900 mb-6">Recommended for You</h2>
                        <div class="space-y-6">
                            <div class="flex items-center">
                                <img src="https://via.placeholder.com/80" alt="Course Thumbnail" class="w-20 h-20 object-cover rounded-lg mr-4">
                                <div>
                                    <h3 class="text-lg font-medium text-gray-900">Advanced JavaScript Techniques</h3>
                                    <p class="text-base text-gray-600">Enhance your JS skills</p>
                                </div>
                            </div>
                            <div class="flex items-center">
                                <img src="https://via.placeholder.com/80" alt="Course Thumbnail" class="w-20 h-20 object-cover rounded-lg mr-4">
                                <div>
                                    <h3 class="text-lg font-medium text-gray-900">Machine Learning Fundamentals</h3>
                                    <p class="text-base text-gray-600">Start your ML journey</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Right Column -->
            <div class="space-y-8">
                <!-- Calendar -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-2xl font-semibold text-gray-900 mb-6">Calendar</h2>
                    <div id="calendar" class="grid grid-cols-7 gap-2">
                        <!-- Calendar will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Upcoming Deadlines -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-2xl font-semibold text-gray-900 mb-6">Upcoming Deadlines</h2>
                    <div class="space-y-6">
                        <div class="flex items-center">
                            <div class="rounded-full bg-red-100 p-3 mr-6">
                                <i class="fas fa-exclamation text-red-600 text-2xl"></i>
                            </div>
                            <div>
                                <p class="text-lg font-medium text-gray-900">Python Advanced Quiz</p>
                                <p class="text-base text-gray-600">Due in 2 days</p>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <div class="rounded-full bg-orange-100 p-3 mr-6">
                                <i class="fas fa-file-alt text-orange-600 text-2xl"></i>
                            </div>
                            <div>
                                <p class="text-lg font-medium text-gray-900">Web Development Project</p>
                                <p class="text-base text-gray-600">Due in 5 days</p>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <div class="rounded-full bg-yellow-100 p-3 mr-6">
                                <i class="fas fa-tasks text-yellow-600 text-2xl"></i>
                            </div>
                            <div>
                                <p class="text-lg font-medium text-gray-900">Data Science Assignment</p>
                                <p class="text-base text-gray-600">Due in 7 days</p>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Study Time Tracker -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-2xl font-semibold text-gray-900 mb-6">Study Time This Week</h2>
                    <canvas id="studyTimeChart"></canvas>
                </div>
            </div>
            </div>
        </main>
</div>

<script>
    // Progress Chart
    var ctx = document.getElementById('progressChart').getContext('2d');
    var progressChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5'],
            datasets: [{
                label: 'Progress',
                data: [20, 35, 45, 60, 72],
                backgroundColor: 'rgba(59, 130, 246, 0.2)',
                borderColor: 'rgba(59, 130, 246, 1)',
                borderWidth: 3,
                pointBackgroundColor: 'rgba(59, 130, 246, 1)',
                pointRadius: 6,
                pointHoverRadius: 8,
                tension: 0.3
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true,
                    max: 100,
                    ticks: {
                        callback: function(value) {
                            return value + '%';
                        }
                    }
                }
            },
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return 'Progress: ' + context.parsed.y + '%';
                        }
                    }
                }
            }
        }
    });

    // Skill Charts
    var pythonCtx = document.getElementById('pythonSkillChart').getContext('2d');
    var pythonSkillChart = new Chart(pythonCtx, {
        type: 'doughnut',
        data: {
            labels: ['Completed', 'Remaining'],
            datasets: [{
                data: [75, 25],
                backgroundColor: ['rgba(59, 130, 246, 0.8)', 'rgba(229, 231, 235, 0.8)'],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            cutout: '70%',
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return context.label + ': ' + context.parsed + '%';
                        }
                    }
                }
            }
        }
    });

    var webDevCtx = document.getElementById('webDevSkillChart').getContext('2d');
    var webDevSkillChart = new Chart(webDevCtx, {
        type: 'doughnut',
        data: {
            labels: ['Completed', 'Remaining'],
            datasets: [{
                data: [60, 40],
                backgroundColor: ['rgba(16, 185, 129, 0.8)', 'rgba(229, 231, 235, 0.8)'],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            cutout: '70%',
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return context.label + ': ' + context.parsed + '%';
                        }
                    }
                }
            }
        }
    });

    // Current Time
    var userTimezone = "{{ request.user.timezone }}";
    function updateTime() {
        var now = new Date();
        var timeString = now.toLocaleTimeString('en-US', {
            hour: 'numeric',
            minute: '2-digit',
            hour12: true,
            timeZone: userTimezone // Use the user's timezone
        });
        document.getElementById('current-time').textContent = timeString;
    }
    updateTime();
    setInterval(updateTime, 1000);

    // Simple Calendar
    function generateCalendar() {
        const calendar = document.getElementById('calendar');
        const currentDate = new Date();
        const currentMonth = currentDate.getMonth();
        const currentYear = currentDate.getFullYear();

        const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
        const firstDayOfMonth = new Date(currentYear, currentMonth, 1).getDay();

        const monthNames = ["January", "February", "March", "April", "May", "June",
            "July", "August", "September", "October", "November", "December"
        ];

        // Add month and year
        const monthYearElement = document.createElement('div');
        monthYearElement.textContent = monthNames[currentMonth] + ' ' + currentYear;
        monthYearElement.classList.add('col-span-7', 'text-center', 'text-xl', 'font-semibold', 'mb-4');
        calendar.appendChild(monthYearElement);

        const dayNames = ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'];

        // Add day names
        dayNames.forEach(day => {
            const dayElement = document.createElement('div');
            dayElement.textContent = day;
            dayElement.classList.add('text-center', 'font-semibold', 'text-gray-500');
            calendar.appendChild(dayElement);
        });

        // Add empty cells for days before the first day of the month
        for (let i = 0; i < firstDayOfMonth; i++) {
            const emptyDay = document.createElement('div');
            calendar.appendChild(emptyDay);
        }

        // Add days of the month
        for (let day = 1; day <= daysInMonth; day++) {
            const dayElement = document.createElement('div');
            dayElement.textContent = day;
            dayElement.classList.add('text-center', 'py-1', 'hover:bg-gray-100', 'rounded', 'cursor-pointer');
            if (day === currentDate.getDate()) {
                dayElement.classList.add('bg-blue-500', 'text-white', 'font-semibold');
            }
            calendar.appendChild(dayElement);
        }
    }

    generateCalendar();



    // New Study Time Chart
    var studyTimeCtx = document.getElementById('studyTimeChart').getContext('2d');
        var studyTimeChart = new Chart(studyTimeCtx, {
            type: 'bar',
            data: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                datasets: [{
                    label: 'Hours Studied',
                    data: [2, 3, 1.5, 4, 2.5, 3.5, 1],
                    backgroundColor: 'rgba(59, 130, 246, 0.8)',
                    borderColor: 'rgba(59, 130, 246, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 5,
                        ticks: {
                            stepSize: 1
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
</script>


{% endblock %}